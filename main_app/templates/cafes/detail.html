{% extends 'base.html' %}

{% block content %} 

<div class="card">
    <div class="card-content cafe">
      <div class="img-container cafe-image">
        {% load static %} 
        <img width="150px" height="150px" src={% static cafe.cafe_image|cut:'main_app/static/' %} />
      </div>

      <div class="cafe-details">
      <span class="card-title">{{ cafe.cafe_name }}</span>
      <p>Bio: {{ cafe.cafe_bio }}</p>
      <p>Established: {{ cafe.date_founded }}</p>
      <p>Address: {{ cafe.address_line_1 }}, <br> 
        {{ cafe.address_line_2 }}, <br> 
        {{ cafe.address_city }}, <br>
        {{ cafe.address_county }}, <br>
        {{ cafe.address_country }}, <br>
        {{ cafe.address_postcode }}</p>
      </div>

      <div class="card-action">
        <a href="{% url 'cafes_update' cafe.id %}">Edit</a>
        <a href="{% url 'cafes_delete' cafe.id %}">Delete</a>
      </div>

  </div>
</div>



<div>
  <form method="post" action="{% url 'add_brewing_method' cafe.id %}">
    {% csrf_token %} 
    {{ brewing_method_form.as_p }}
    <input type="submit" value="Add Brewing Method" class="btn" />
  </form>
</div>

<div>
  <table class="striped">
    <thead>
      <tr>
        <th>Brewing Method </th>
        <th>Bio</th>
        <th>Image</th>
      </tr>
    </thead>
{{ cafe }}
    <tbody>
      {% for brewing_method in cafe.brewingmethod_set.all %} 
      <tr>
        <td>{{ brewing_method.method_name }}</td>
        <td>{{ brewing_method.method_bio }}</td>
        <td>{{ brewing_method.method_image }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>


<div>
  <form method="post" action="{% url 'add_event' cafe.id %}">
    {% csrf_token %} 
    {{ event_form.as_p }}
    <input type="submit" value="Add Event" class="btn" />
  </form>
</div>

<div>
  <table class="striped">
    <thead>
      <tr>
        <th>Event Name </th>
        <th>Description</th>
        <th>Type</th>
        <th>Date</th>
        <th>Time From</th>
        <th>Time To</th>
        <th>Image</th>
      </tr>
    </thead>
{{ cafe }}
    <tbody>
      {% for event in cafe.event_set.all %} 
      <tr>
        <td>{{ event.event_name }}</td>
        <td>{{ event.event_description }}</td>
        <td>{{ event.event_type }}</td>
        <td>{{ event.event_date }}</td>
        <td>{{ event.event_time_from }}</td>
        <td>{{ event.event_time_to }}</td>
        <td>{{ event.event_image }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script>

  let selectEl = document.getElementById('id_method_name')
  M.FormSelect.init(selectEl);

  let selectEventEl = document.getElementById('id_event_name')
  M.FormSelect.init(selectEventEl);

</script>
{% endblock %}